var e,t=require("three"),n=(e=require("gsap/TweenMax"))&&"object"==typeof e&&"default"in e?e.default:e;module.exports=function(e){function i(){for(var e=arguments,t=0;t<arguments.length;t++)if(void 0!==e[t])return e[t]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var o=e.parent,r=e.displacementImage,a=e.image1,s=e.image2,l=i(e.images,[e.image1,e.image2]),f=i(e.imagesRatio,1),d=i(e.intensity1,e.intensity,1),u=i(e.intensity2,e.intensity,1),v=i(e.angle,Math.PI/4),m=i(e.angle1,v),c=i(e.angle2,3*-v),p=i(e.speedIn,e.speed,1.6),g=i(e.speedOut,e.speed,1.2),h=i(e.hover,!0),y=i(e.easing,Expo.easeOut),x=i(e.video,!1),F=i(e.transitionDelay,3e3),w=0,L=1,H=void 0,W=void 0,V=void 0,E=null,P=null,M=null,S=null,U=null;if(o)if((l||a&&s)&&r){var C,D,R=new t.Scene,b=new t.OrthographicCamera(o.offsetWidth/-2,o.offsetWidth/2,o.offsetHeight/2,o.offsetHeight/-2,1,1e3),_=new t.WebGLRenderer({antialias:!1,alpha:!0}),z=f,T=function(){_.render(R,b)};b.position.z=1,_.setPixelRatio(2),_.setClearColor(16777215,0),_.setSize(o.offsetWidth,o.offsetHeight),o.appendChild(_.domElement),o.offsetHeight/o.offsetWidth<z?(C=1,D=o.offsetHeight/o.offsetWidth/z):(C=o.offsetWidth/o.offsetHeight*z,D=1),(S=new t.TextureLoader).crossOrigin="",(M=S.load(r,T)).magFilter=M.minFilter=t.LinearFilter,x?function(){var e=function(){requestAnimationFrame(e),_.render(R,b)};e();var n=document.createElement("video");n.autoplay=!0,n.loop=!0,n.src=a,n.load();var i=document.createElement("video");i.autoplay=!0,i.loop=!0,i.src=s,i.load();var o=new t.VideoTexture(n),r=new t.VideoTexture(i);o.magFilter=r.magFilter=t.LinearFilter,o.minFilter=r.minFilter=t.LinearFilter,i.addEventListener("loadeddata",function(){i.play(),(r=new t.VideoTexture(i)).magFilter=t.LinearFilter,r.minFilter=t.LinearFilter,H.uniforms.texture2.value=r},!1),n.addEventListener("loadeddata",function(){n.play(),(o=new t.VideoTexture(n)).magFilter=t.LinearFilter,o.minFilter=t.LinearFilter,H.uniforms.texture1.value=o},!1)}():j(),H=new t.ShaderMaterial({uniforms:{intensity1:{type:"f",value:d},intensity2:{type:"f",value:u},dispFactor:{type:"f",value:0},angle1:{type:"f",value:m},angle2:{type:"f",value:c},texture1:{type:"t",value:E},texture2:{type:"t",value:P},disp:{type:"t",value:M},res:{type:"vec4",value:new t.Vector4(o.offsetWidth,o.offsetHeight,C,D)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),R=new t.Scene,V=new t.PlaneBufferGeometry(o.offsetWidth,o.offsetHeight,1),W=new t.Mesh(V,H),R.add(W),h&&(o.addEventListener("mouseenter",I),o.addEventListener("touchstart",I),o.addEventListener("mouseleave",O),o.addEventListener("touchend",O)),window.addEventListener("resize",function(e){o.offsetHeight/o.offsetWidth<z?(C=1,D=o.offsetHeight/o.offsetWidth/z):(C=o.offsetWidth/o.offsetHeight*z,D=1),W.material.uniforms.res.value=new t.Vector4(o.offsetWidth,o.offsetHeight,C,D),_.setSize(o.offsetWidth,o.offsetHeight),T()}),this.next=I,this.playSlideshow=function(){var e=0;return q(e),U=setInterval(function(){I(),q(e=L),j(),H.uniforms.texture1.value=E,H.uniforms.texture2.value=P,H.uniforms.dispFactor.value=0},F)},this.stopSlideshow=function(){U&&clearInterval(U)},this.previous=O}else console.warn("One or more images are missing");else console.warn("Parent missing");function I(){n.to(H.uniforms.dispFactor,p,{value:1,ease:y,onUpdate:T,onComplete:T})}function O(){n.to(H.uniforms.dispFactor,g,{value:0,ease:y,onUpdate:T,onComplete:T})}function q(e){w=e,L=e==l.length-1?0:e+1}function j(){E=P||S.load(l[w],T),P=S.load(l[L],T),E.magFilter=P.magFilter=t.LinearFilter,E.minFilter=P.minFilter=t.LinearFilter}};
//# sourceMappingURL=hover-effect.js.map
