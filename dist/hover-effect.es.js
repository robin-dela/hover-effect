import{Scene as e,OrthographicCamera as t,WebGLRenderer as n,TextureLoader as i,LinearFilter as o,ShaderMaterial as a,Vector4 as r,PlaneBufferGeometry as s,Mesh as l,VideoTexture as f}from"three";import d from"gsap/TweenMax";export default function(u){function v(){for(var e=arguments,t=0;t<arguments.length;t++)if(void 0!==e[t])return e[t]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var m=u.parent,c=u.displacementImage,p=u.image1,g=u.image2,h=v(u.images,[u.image1,u.image2]),y=v(u.imagesRatio,1),x=v(u.intensity1,u.intensity,1),w=v(u.intensity2,u.intensity,1),F=v(u.angle,Math.PI/4),H=v(u.angle1,F),W=v(u.angle2,3*-F),E=v(u.speedIn,u.speed,1.6),P=v(u.speedOut,u.speed,1.2),U=v(u.hover,!0),D=v(u.easing,Expo.easeOut),C=v(u.video,!1),L=v(u.transitionDelay,3e3),M=0,R=1,V=void 0,_=void 0,z=void 0,S=null,b=null,I=null,O=null,j=null;if(m)if((h||p&&g)&&c){var q,A,T=new e,k=new t(m.offsetWidth/-2,m.offsetWidth/2,m.offsetHeight/2,m.offsetHeight/-2,1,1e3),B=new n({antialias:!1,alpha:!0}),G=y,J=function(){B.render(T,k)};k.position.z=1,B.setPixelRatio(2),B.setClearColor(16777215,0),B.setSize(m.offsetWidth,m.offsetHeight),m.appendChild(B.domElement),m.offsetHeight/m.offsetWidth<G?(q=1,A=m.offsetHeight/m.offsetWidth/G):(q=m.offsetWidth/m.offsetHeight*G,A=1),(O=new i).crossOrigin="",(I=O.load(c,J)).magFilter=I.minFilter=o,C?function(){var e=function(){requestAnimationFrame(e),B.render(T,k)};e();var t=document.createElement("video");t.autoplay=!0,t.loop=!0,t.src=p,t.load();var n=document.createElement("video");n.autoplay=!0,n.loop=!0,n.src=g,n.load();var i=new f(t),a=new f(n);i.magFilter=a.magFilter=o,i.minFilter=a.minFilter=o,n.addEventListener("loadeddata",function(){n.play(),(a=new f(n)).magFilter=o,a.minFilter=o,V.uniforms.texture2.value=a},!1),t.addEventListener("loadeddata",function(){t.play(),(i=new f(t)).magFilter=o,i.minFilter=o,V.uniforms.texture1.value=i},!1)}():X(),V=new a({uniforms:{intensity1:{type:"f",value:x},intensity2:{type:"f",value:w},dispFactor:{type:"f",value:0},angle1:{type:"f",value:H},angle2:{type:"f",value:W},texture1:{type:"t",value:S},texture2:{type:"t",value:b},disp:{type:"t",value:I},res:{type:"vec4",value:new r(m.offsetWidth,m.offsetHeight,q,A)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),T=new e,z=new s(m.offsetWidth,m.offsetHeight,1),_=new l(z,V),T.add(_),U&&(m.addEventListener("mouseenter",K),m.addEventListener("touchstart",K),m.addEventListener("mouseleave",N),m.addEventListener("touchend",N)),window.addEventListener("resize",function(e){m.offsetHeight/m.offsetWidth<G?(q=1,A=m.offsetHeight/m.offsetWidth/G):(q=m.offsetWidth/m.offsetHeight*G,A=1),_.material.uniforms.res.value=new r(m.offsetWidth,m.offsetHeight,q,A),B.setSize(m.offsetWidth,m.offsetHeight),J()}),this.next=K,this.playSlideshow=function(){var e=0;return Q(e),j=setInterval(function(){K(),Q(e=R),X(),V.uniforms.texture1.value=S,V.uniforms.texture2.value=b,V.uniforms.dispFactor.value=0},L)},this.stopSlideshow=function(){j&&clearInterval(j)},this.previous=N}else console.warn("One or more images are missing");else console.warn("Parent missing");function K(){d.to(V.uniforms.dispFactor,E,{value:1,ease:D,onUpdate:J,onComplete:J})}function N(){d.to(V.uniforms.dispFactor,P,{value:0,ease:D,onUpdate:J,onComplete:J})}function Q(e){M=e,R=e==h.length-1?0:e+1}function X(){S=b||O.load(h[M],J),b=O.load(h[R],J),S.magFilter=b.magFilter=o,S.minFilter=b.minFilter=o}}
//# sourceMappingURL=hover-effect.es.js.map
